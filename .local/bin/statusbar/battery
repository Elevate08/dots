#!/bin/sh

# Prints all batteries, their percentage remaining and an emoji corresponding
# to charge status (ğŸ”Œ for plugged up, ğŸ”‹ for discharging on battery, etc.).

case $BUTTON in
    1) pgrep -x dunst >/dev/null && notify-send "ğŸ”‹ Battery module" "$(acpi -b | sort -r)";;
    3) pgrep -x dunst >/dev/null && notify-send "ğŸ”‹ Battery module"
        "ğŸ”‹: discharging
        ğŸ›‘: not charging
        â™»: stagnant charge
        ğŸ”Œ: charging
        âš¡: charged
        â—: battery very low!";;
esac

IFS=$'\n'
bat=$(acpi -b | grep -v Unknown)
warn="â—"

bat_num=$(echo $bat | cut -d ":" -f 1)
status=$(echo $bat | cut -d ":" -f 2 | cut -d "," -f 1 | sed -e "s/^\s*//")
capacity=$(echo $bat | cut -d ":" -f 2 | cut -d "," -f 2 | sed -e "s/^\s*//")
time=$(echo $bat | cut -d "," -f 3 | cut -d " " -f 1-2 )
num_capacity=$(echo $capacity | sed "s/%//")

status=$(echo $status | sed "s/Discharging/ğŸ”‹/;s/Not charging/ğŸ›‘/;s/Charging/ğŸ”Œ/;s/Unknown/â™»ï¸/;s/Full/âš¡/")

# if [ -z "$num_capacity" ]
# then
#     printf "âš¡"
# elif [ "$num_capacity" -ge 10 ]

if [ -n "$num_capacity" ] && [ "$num_capacity" -ge 10 ]
then
    if [ "$num_capacity" -le 25 ]
    then
        printf "%s%s%s%s%%" "$warn" "$status" "$capacity" "$time "
    else
        printf "%s%s%s%%" "$status" "$capacity" "$time "
    fi
else
    if [ -n "$num_capacity" ]
    then 
        printf "%s%s%%" "$bat_num" "â˜ ï¸ " 
    fi
fi
